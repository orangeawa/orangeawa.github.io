import{u as k,h as c,l as U,r as y,o as C,f as B,a as e,w as o,e as t,b as f,t as $,i as v,E as r,d as i,m as T,n as D,p as _,q as g,v as I,x as m}from"./index-C40GVefy.js";const M={class:"max-w-screen-md mx-auto py-14"},N={class:"flex py-4"},F={slot:"footer",class:"dialog-footer"},A={__name:"UserList",setup(S){const h=k(),w=c([]),s=c({name:"",email:"",password:""}),d=c(!1),V=c(0);function p(){v.get("http://localhost:25567/users/list").then(function(n){w.value=n.data}).catch(function(n){console.error("Error fetching data:",n)})}function b(n){I.confirm("此操作将永久删除该用户, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{v.delete(`http://localhost:25567/users/delete/${n}`,{headers:{Authorization:h.token}}).then(()=>{m({type:"success",message:"删除成功!"}),p()}).catch(l=>{console.log(l),m({type:"error",message:"删除失败: "+l.message})})}).catch(()=>{m({type:"info",message:"已取消删除"})})}function x(){v.post("http://localhost:25567/users",s.value).then(()=>{m({type:"success",message:"添加成功!"}),p(),s.value={name:"",email:"",password:""},d.value=!1}).catch(n=>{m({type:"error",message:"添加失败: "+n.message})})}return U(()=>{p()}),(n,l)=>{const u=y("el-table-column"),E=y("el-dialog");return C(),B("div",M,[e(t(T),{data:w.value,stripe:"",style:{width:"auto"}},{default:o(()=>[e(u,{type:"selection",width:"55"}),e(u,{property:"_id",label:"id",width:"240"}),e(u,{property:"name",label:"名字",width:"120"}),e(u,{property:"passwd",label:"密码",width:"240","show-overflow-tooltip":""}),e(u,{label:"操作",width:"120"},{default:o(a=>[e(t(r),{type:"danger",onClick:q=>b(a.row._id)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),f("div",N,[e(t(r),{type:"primary",onClick:l[0]||(l[0]=a=>d.value=!0)},{default:o(()=>[i("添加")]),_:1})]),e(E,{title:"添加用户",modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=a=>d.value=a)},{default:o(()=>[e(t(D),{model:s.value},{default:o(()=>[e(t(_),{label:"名字"},{default:o(()=>[e(t(g),{modelValue:s.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>s.value.name=a)},null,8,["modelValue"])]),_:1}),e(t(_),{label:"邮箱"},{default:o(()=>[e(t(g),{modelValue:s.value.email,"onUpdate:modelValue":l[2]||(l[2]=a=>s.value.email=a)},null,8,["modelValue"])]),_:1}),e(t(_),{label:"密码"},{default:o(()=>[e(t(g),{modelValue:s.value.password,"onUpdate:modelValue":l[3]||(l[3]=a=>s.value.password=a),type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),f("div",F,[e(t(r),{onClick:l[4]||(l[4]=a=>d.value=!1)},{default:o(()=>[i("取消")]),_:1}),e(t(r),{type:"primary",onClick:x},{default:o(()=>[i("确认")]),_:1})])]),_:1},8,["modelValue"]),e(t(r),{onClick:l[6]||(l[6]=a=>p())},{default:o(()=>[i("发送请求")]),_:1}),f("div",null,$(V.value),1)])}}};export{A as default};
